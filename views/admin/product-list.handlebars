<h1 style="text-align:center; margin-bottom: 2rem;">üõ†Ô∏è Administraci√≥n de Productos</h1>

<div style="text-align: center; margin-bottom: 1.5rem;">
  <a href="/admin/products/new" style="background-color: #28a745; color: white; padding: 10px 15px; border-radius: 5px; text-decoration: none;">
    ‚ûï Agregar Nuevo Producto
  </a>
</div>

<table style="width: 90%; margin: auto; border-collapse: collapse; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
  <thead>
    <tr style="background-color: #007bff; color: white;">
      <th style="padding: 10px;">Imagen</th>
      <th style="padding: 10px;">T√≠tulo</th>
      <th style="padding: 10px;">Precio</th>
      <th style="padding: 10px;">Acciones</th>
    </tr>
  </thead>
  <tbody>
    {{#each products}}
      <tr style="text-align: center;">
        <td style="padding: 10px;">
          <img src="{{this.image}}" alt="{{this.title}}" style="height: 60px; object-fit: cover; border-radius: 5px;" />
        </td>
        <td style="padding: 10px;">{{this.title}}</td>
        <td colspan="4" style="text-align: left; font-size: 0.85rem; color: #555; padding: 5px 10px; background-color: #f9f9f9;">
        <strong>Creado por:</strong> {{this.createdByEmail}} |
        <strong>Modificado por:</strong> {{this.updatedByEmail}}
        </td>
        <td style="padding: 10px;">${{this.price}}</td>
        <td style="padding: 10px;">
          <a href="/admin/products/{{this._id}}/edit" style="margin-right: 10px; color: #ffc107;">‚úèÔ∏è Editar</a>
          <form action="/admin/products/{{this._id}}/delete" method="POST" style="display:inline;">
            <button type="submit" style="color: red; background: none; border: none; cursor: pointer;">üóëÔ∏è Eliminar</button>
          </form>
        </td>
      </tr>
    {{/each}}
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  const urlParams = new URLSearchParams(window.location.search);
  if (urlParams.get('success') === 'true') {
    Swal.fire({
      icon: 'success',
      title: 'Producto creado',
      text: 'El producto se cre√≥ correctamente.',
      timer: 2000,
      showConfirmButton: false
    }).then(() => {
      const cleanUrl = window.location.origin + window.location.pathname;
      window.history.replaceState({}, document.title, cleanUrl);
    });
  }
  if (urlParams.get('success') === 'true') {
    Swal.fire({
      icon: 'success',
      title: 'Producto creado',
      text: 'El producto se cre√≥ correctamente.',
      timer: 2000,
      showConfirmButton: false
    }).then(() => {
      const cleanUrl = window.location.origin + window.location.pathname;
      window.history.replaceState({}, document.title, cleanUrl);
    });
  }

  if (urlParams.get('updated') === 'true') {
    Swal.fire({
      icon: 'success',
      title: 'Producto actualizado',
      text: 'El producto fue modificado correctamente.',
      timer: 2000,
      showConfirmButton: false
    }).then(() => {
      const cleanUrl = window.location.origin + window.location.pathname;
      window.history.replaceState({}, document.title, cleanUrl);
    });
  }

  if (urlParams.get('deleted') === 'true') {
    Swal.fire({
      icon: 'success',
      title: 'Producto eliminado',
      text: 'El producto fue eliminado correctamente.',
      timer: 2000,
      showConfirmButton: false
    }).then(() => {
      const cleanUrl = window.location.origin + window.location.pathname;
      window.history.replaceState({}, document.title, cleanUrl);
    });
  }
</script>

  </tbody>
</table>
